<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Quản lý quán bánh</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; }
    nav { background-color: #333; display: flex; flex-wrap: wrap; }
    nav button {
      flex: 1; padding: 1rem; background: #444;
      color: white; border: none; cursor: pointer;
    }
    nav button.active { background: #2196F3; }
    .tab-content { display: none; padding: 1rem; }
    .tab-content.active { display: block; }
    h2 { margin-top: 0; }
    table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    .warning { color: red; font-weight: bold; }
    input, select, button { margin: 5px 5px 5px 0; padding: 5px; }
  </style>
</head>
<body>
  <nav>
    <button onclick="showTab('nguyenlieu')" class="active">Nguyên liệu</button>
    <button onclick="showTab('congthuc')">Công thức</button>
    <button onclick="showTab('sanxuat')">Sản xuất</button>
    <button onclick="showTab('khobanh')">Kho bánh</button>
    <button onclick="showTab('banhang')">Bán hàng</button>
    <button onclick="showTab('baocao')">Báo cáo</button>
  </nav>

  <div id="nguyenlieu" class="tab-content active">
    <h2>Quản lý Nguyên liệu</h2>
    <table id="nguyenlieuTable">
      <thead>
        <tr><th>Tên</th><th>Số lượng</th><th>Đơn vị</th><th>Trạng thái</th></tr>
      </thead>
      <tbody></tbody>
    </table>
    <h3>Nhập / Xuất nguyên liệu</h3>
    <input type="text" id="tenNguyenLieu" placeholder="Tên nguyên liệu">
    <input type="number" id="soLuongNguyenLieu" placeholder="Số lượng">
    <select id="loaiGiaoDich">
      <option value="nhap">Nhập</option>
      <option value="xuat">Xuất</option>
    </select>
    <button onclick="capNhatNguyenLieu()">Lưu</button>
    <h3>Thêm nguyên liệu mới</h3>
    <input type="text" id="tenMoi" placeholder="Tên">
    <input type="text" id="donViMoi" placeholder="Đơn vị">
    <input type="number" id="soLuongMoi" placeholder="Số lượng ban đầu">
    <button onclick="themNguyenLieu()">Thêm</button>
  </div>

  <div id="congthuc" class="tab-content">
    <h2>Quản lý Công thức</h2>
    <table>
      <thead>
        <tr><th>Tên bánh</th><th>Nguyên liệu</th></tr>
      </thead>
      <tbody id="congThucTable"></tbody>
    </table>
  </div>

  <div id="sanxuat" class="tab-content">
    <h2>Ghi nhận sản xuất</h2>
    <input type="text" id="tenBanhSX" placeholder="Tên bánh">
    <input type="number" id="soLuongSX" placeholder="Số lượng">
    <button onclick="ghiNhanSanXuat()">Ghi nhận</button>
    <table>
      <thead><tr><th>Ngày</th><th>Tên bánh</th><th>Số lượng</th></tr></thead>
      <tbody id="lichSanXuatTable"></tbody>
    </table>
  </div>

  <div id="khobanh" class="tab-content">
    <h2>Kho Bánh</h2>
    <table>
      <thead><tr><th>Tên bánh</th><th>Số lượng tồn</th></tr></thead>
      <tbody id="khoBanhTable"></tbody>
    </table>
  </div>

  <div id="banhang" class="tab-content">
    <h2>Bán Hàng</h2>
    <input type="text" id="tenBanhBan" placeholder="Tên bánh">
    <input type="number" id="soLuongBan" placeholder="Số lượng bán">
    <button onclick="ghiNhanBanHang()">Ghi nhận bán</button>
    <table>
      <thead><tr><th>Ngày</th><th>Tên bánh</th><th>Số lượng bán</th></tr></thead>
      <tbody id="lichBanHangTable"></tbody>
    </table>
  </div>

  <div id="baocao" class="tab-content">
    <h2>Báo Cáo</h2>
    <div id="baoCaoNoiDung"></div>
  </div>

  <script>
    // Dữ liệu mẫu
    const nguyenLieu = [
      { ten: "Bột mì", soLuong: 5, donVi: "kg" },
      { ten: "Trứng", soLuong: 20, donVi: "quả" },
      { ten: "Đường", soLuong: 3, donVi: "kg" }
    ];

    const congThuc = {
      "Bánh mì": { "Bột mì": 0.2, "Men": 0.005, "Muối": 0.002 },
      "Bánh kem": { "Bột mì": 0.3, "Sữa": 0.1, "Trứng": 2 }
    };

    const lichSanXuat = [];
    const banHang = [];

    function showTab(tabId) {
      document.querySelectorAll(".tab-content").forEach(tab => tab.classList.remove("active"));
      document.querySelectorAll("nav button").forEach(btn => btn.classList.remove("active"));
      document.getElementById(tabId).classList.add("active");
      event.target.classList.add("active");

      switch (tabId) {
        case "nguyenlieu": loadNguyenLieu(); break;
        case "congthuc": loadCongThuc(); break;
        case "sanxuat": loadSanXuat(); break;
        case "khobanh": loadKhoBanh(); break;
        case "banhang": loadBanHang(); break;
        case "baocao": loadBaoCao(); break;
      }
    }

    function loadNguyenLieu() {
      const tbody = document.querySelector("#nguyenlieuTable tbody");
      tbody.innerHTML = "";
      nguyenLieu.forEach(nl => {
        const row = document.createElement("tr");
        const warning = nl.soLuong < 2 ? "<span class='warning'>Gần hết</span>" : "";
        row.innerHTML = `<td>${nl.ten}</td><td>${nl.soLuong}</td><td>${nl.donVi}</td><td>${warning}</td>`;
        tbody.appendChild(row);
      });
    }

    function themNguyenLieu() {
      const ten = document.getElementById("tenMoi").value;
      const donVi = document.getElementById("donViMoi").value;
      const soLuong = parseFloat(document.getElementById("soLuongMoi").value);
      if (ten && donVi && !isNaN(soLuong)) {
        nguyenLieu.push({ ten, donVi, soLuong });
        loadNguyenLieu();
      }
    }

    function capNhatNguyenLieu() {
      const ten = document.getElementById("tenNguyenLieu").value;
      const soLuong = parseFloat(document.getElementById("soLuongNguyenLieu").value);
      const loai = document.getElementById("loaiGiaoDich").value;
      const item = nguyenLieu.find(nl => nl.ten.toLowerCase() === ten.toLowerCase());
      if (item && !isNaN(soLuong)) {
        if (loai === "nhap") item.soLuong += soLuong;
        else if (loai === "xuat") item.soLuong = Math.max(0, item.soLuong - soLuong);
        loadNguyenLieu();
      }
    }

    function loadCongThuc() {
      const tbody = document.getElementById("congThucTable");
      tbody.innerHTML = "";
      for (let ten in congThuc) {
        const ngl = Object.entries(congThuc[ten]).map(([k,v]) => `${k}: ${v}`).join(", ");
        const row = document.createElement("tr");
        row.innerHTML = `<td>${ten}</td><td>${ngl}</td>`;
        tbody.appendChild(row);
      }
    }

    function ghiNhanSanXuat() {
      const ten = document.getElementById("tenBanhSX").value;
      const sl = parseInt(document.getElementById("soLuongSX").value);
      if (ten && !isNaN(sl)) {
        lichSanXuat.push({ ten, soLuong: sl, ngay: new Date().toISOString().split('T')[0] });
        loadSanXuat();
        loadKhoBanh();
        loadBaoCao();
      }
    }

    function loadSanXuat() {
      const tbody = document.getElementById("lichSanXuatTable");
      tbody.innerHTML = "";
      lichSanXuat.forEach(item => {
        const row = document.createElement("tr");
        row.innerHTML = `<td>${item.ngay}</td><td>${item.ten}</td><td>${item.soLuong}</td>`;
        tbody.appendChild(row);
      });
    }

    function ghiNhanBanHang() {
      const ten = document.getElementById("tenBanhBan").value;
      const sl = parseInt(document.getElementById("soLuongBan").value);
      if (ten && !isNaN(sl)) {
        banHang.push({ ten, soLuong: sl, ngay: new Date().toISOString().split('T')[0] });
        loadBanHang();
        loadKhoBanh();
        loadBaoCao();
      }
    }

    function loadBanHang() {
      const tbody = document.getElementById("lichBanHangTable");
      tbody.innerHTML = "";
      banHang.forEach(item => {
        const row = document.createElement("tr");
        row.innerHTML = `<td>${item.ngay}</td><td>${item.ten}</td><td>${item.soLuong}</td>`;
        tbody.appendChild(row);
      });
    }

    function loadKhoBanh() {
      const kho = {};
      lichSanXuat.forEach(sp => {
        kho[sp.ten] = (kho[sp.ten] || 0) + sp.soLuong;
      });
      banHang.forEach(sp => {
        kho[sp.ten] = (kho[sp.ten] || 0) - sp.soLuong;
      });
      const tbody = document.getElementById("khoBanhTable");
      tbody.innerHTML = "";
      for (let ten in kho) {
        const row = document.createElement("tr");
        row.innerHTML = `<td>${ten}</td><td>${kho[ten]}</td>`;
        tbody.appendChild(row);
      }
    }

    function loadBaoCao() {
      const ngay = new Date().toISOString().split('T')[0];
      const spSX = {}, spBan = {};
      lichSanXuat.filter(i => i.ngay === ngay).forEach(i => spSX[i.ten] = (spSX[i.ten] || 0) + i.soLuong);
      banHang.filter(i => i.ngay === ngay).forEach(i => spBan[i.ten] = (spBan[i.ten] || 0) + i.soLuong);
      const html = `
        <p><strong>Tổng sản xuất hôm nay:</strong> ${Object.entries(spSX).map(([k,v]) => `${k}: ${v}`).join(", ")}</p>
        <p><strong>Tổng bán hôm nay:</strong> ${Object.entries(spBan).map(([k,v]) => `${k}: ${v}`).join(", ")}</p>
      `;
      document.getElementById("baoCaoNoiDung").innerHTML = html;
      loadKhoBanh();
    }

    window.onload = () => {
      loadNguyenLieu();
    };
  </script>
</body>
</html>

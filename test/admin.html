<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Admin â€“ Cafe Demo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    body {
      font-family: system-ui, sans-serif;
      background: #f5f5f5;
      margin: 0;
      padding: 20px;
    }
    .box {
      max-width: 420px;
      margin: auto;
      background: #fff;
      padding: 20px;
      border-radius: 8px;
    }
    h1 { margin-top: 0; }
    input, button {
      width: 100%;
      padding: 10px;
      margin-top: 10px;
      font-size: 16px;
    }
    button {
      background: #222;
      color: #fff;
      border: none;
      cursor: pointer;
    }
    button:hover { opacity: 0.9; }
    .hidden { display: none; }
    .order {
      padding: 10px;
      border-bottom: 1px solid #ddd;
    }
  </style>
</head>

<body>

<!-- LOGIN -->
<div id="loginBox" class="box">
  <h1>ğŸ” Admin Login</h1>
  <input id="pin" type="password" placeholder="Nháº­p PIN" />
  <button onclick="login()">ÄÄƒng nháº­p</button>
</div>

<!-- ADMIN PANEL -->
<div id="adminBox" class="box hidden">
  <h1>ğŸ“‹ ÄÆ¡n hÃ ng</h1>
  <div id="orders"></div>
  <button onclick="logout()">ÄÄƒng xuáº¥t</button>
</div>

<script type="module">
  import { api } from './js/api.js';

  const token = localStorage.getItem('admin_token');

  // Náº¿u Ä‘Ã£ cÃ³ token â†’ thá»­ load admin
  if (token) {
    loadOrders();
  }

  window.login = async function () {
    const pin = document.getElementById('pin').value.trim();
    if (!pin) return alert('Nháº­p PIN');

    const res = await api.adminLogin(pin);
    if (!res.ok) return alert('Sai PIN');

    localStorage.setItem('admin_token', res.token);
    loadOrders();
  };

  async function loadOrders() {
    const token = localStorage.getItem('admin_token');
    const res = await api.getOrders(token);

    if (res.error) {
      localStorage.removeItem('admin_token');
      return;
    }

    document.getElementById('loginBox').classList.add('hidden');
    document.getElementById('adminBox').classList.remove('hidden');

    const ordersDiv = document.getElementById('orders');
    ordersDiv.innerHTML = '';

    res.orders.forEach(o => {
      ordersDiv.innerHTML += `
        <div class="order">
          <b>${o.orderId}</b><br>
          BÃ n: ${o.table}<br>
          Tá»•ng: ${o.total}Ä‘<br>
          Tráº¡ng thÃ¡i: ${o.status}
        </div>
      `;
    });
  }

  window.logout = function () {
    localStorage.removeItem('admin_token');
    location.reload();
  };
</script>

</body>
</html>
